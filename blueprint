blueprint:
  name: Raspberry Pi Command with JSON Payload
  description: Send a JSON payload to a specific Raspberry Pi or broadcast to all.
  domain: automation
  input:
    trigger:
      name: Trigger
      description: Define the trigger for the automation.
      selector:
        trigger:
    individual_hostname:
      name: Individual Raspberry Pi Hostname
      description: Enter the hostname of a specific Raspberry Pi (e.g., blueberry01). Leave empty to broadcast to all.
      default: ""
      selector:
        text:
    broadcast:
      name: Broadcast to All
      description: Check to send to all Raspberry Pis. If checked, the individual hostname is ignored.
      selector:
        boolean:
    payload:
      name: JSON Payload
      description: The entire payload in JSON format.
      selector:
        text:

trigger: !input 'trigger'

action:
  - service: mqtt.publish
    data_template:
      topic: >
        {% if broadcast %}
          home/+/action
        {% else %}
          home/{{ individual_hostname | lower }}/action
        {% endif %}
      payload: "{{ payload }}"
